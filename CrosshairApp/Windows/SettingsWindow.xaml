<Window x:Class="CrosshairApp.Windows.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Crosshair Settings"
        Height="850" Width="450"
        WindowStyle="SingleBorderWindow"
        ResizeMode="CanResize"
        Background="#1e1e1e"
        Topmost="True">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        <SolidColorBrush x:Key="ControlBackground" Color="#3c3c3c"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#dcdcdc"/>
        <SolidColorBrush x:Key="Accent" Color="#007acc"/>
        <SolidColorBrush x:Key="BorderColor" Color="#4a4a4a"/>

        <Style TargetType="GroupBox">
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="Margin" Value="0,0,0,10"/>
            <Setter Property="Padding" Value="10"/>
        </Style>

        <Style TargetType="Label">
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Background" Value="{StaticResource ControlBackground}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="Padding" Value="5"/>
        </Style>
        
        <Style TargetType="Slider">
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style TargetType="Button">
            <Setter Property="Background" Value="{StaticResource Accent}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="10,5"/> 
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" 
                                            VerticalAlignment="Center"
                                            Margin="{TemplateBinding Padding}"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ResetButtonStyle" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="#444444"/>
            <Setter Property="Padding" Value="5,0"/>
            <Setter Property="Margin" Value="5,0,0,0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="ToolTip" Value="Reset to Default"/>
            <Setter Property="Width" Value="25"/>
            <Setter Property="Height" Value="25"/>
        </Style>
        
        <Style TargetType="RadioButton">
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="Margin" Value="0,5,15,0"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Border Background="{StaticResource Accent}" Padding="15">
            <TextBlock Text="Configuration" FontSize="18" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center"/>
        </Border>

        <ScrollViewer Grid.Row="1" Padding="15" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                 <GroupBox Header="Profile Management">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <ComboBox x:Name="ProfileComboBox" SelectionChanged="OnProfileChanged" Margin="0,0,10,0"/>
                        <Button Grid.Column="1" Content="New" Click="OnAddProfile" Margin="0,0,5,0"/>
                        <Button Grid.Column="2" Content="Delete" Click="OnDeleteProfile"/>
                    </Grid>
                </GroupBox>

                <GroupBox Header="ADS (Right Click Behavior)">
                    <StackPanel>
                         <CheckBox x:Name="AdsEnabledCheck" Content="Enable ADS for this Profile" Foreground="{StaticResource TextPrimary}"
                                  Margin="0,0,0,5" Checked="OnAdsToggle" Unchecked="OnAdsToggle"/>
                        
                        <Label Content="Edit Mode:" FontWeight="Bold" Margin="0,5,0,0"/>
                        <StackPanel Orientation="Horizontal">
                             <RadioButton x:Name="ModeHipfire" Content="Hipfire Settings" IsChecked="True" Checked="OnModeChanged"/>
                            <RadioButton x:Name="ModeAds" Content="ADS Settings" Checked="OnModeChanged"/>
                        </StackPanel>
                        <TextBlock Text="Note: Selecting 'ADS Settings' will preview the ADS crosshair on screen." FontSize="10" Foreground="Gray" Margin="0,5,0,0" TextWrapping="Wrap"/>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="Visual Settings">
                    <StackPanel>
                        <DockPanel Margin="0,0,0,10">
                            <Label Content="Style" DockPanel.Dock="Left"/>
                            <Button DockPanel.Dock="Right" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="CrosshairStyle" Click="OnResetSetting"/>
                            <ComboBox x:Name="StyleCombo" SelectionChanged="OnStyleChanged"/>
                        </DockPanel>

                        <CheckBox x:Name="DynamicColorCheck" Content="Smart Dynamic Color" Foreground="{StaticResource TextPrimary}"
                                  Margin="0,0,0,10" Checked="OnDynamicColorToggle" Unchecked="OnDynamicColorToggle"/>

                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel>
                                <Label Content="Crosshair Color"/>
                                <TextBox x:Name="ColorInput" LostFocus="OnColorTextLostFocus" PreviewTextInput="OnHexInput"/>
                            </StackPanel>
                            <Button Grid.Column="1" Content="Pick" Click="OnPickColor" VerticalAlignment="Bottom" Margin="5,0,0,0"/>
                            <Button Grid.Column="2" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="CrosshairColor" Click="OnResetSetting" VerticalAlignment="Bottom"/>
                        </Grid>
                        
                        <Grid Margin="0,0,0,10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel>
                                <Label Content="Outline Color"/>
                                <TextBox x:Name="OutlineColorInput" LostFocus="OnOutlineTextLostFocus" PreviewTextInput="OnHexInput"/>
                            </StackPanel>
                            <Button Grid.Column="1" Content="Pick" Click="OnPickOutlineColor" VerticalAlignment="Bottom" Margin="5,0,0,0"/>
                            <Button Grid.Column="2" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="OutlineColor" Click="OnResetSetting" VerticalAlignment="Bottom"/>
                        </Grid>
                    </StackPanel>
                </GroupBox>

                <GroupBox Header="Dimensions">
                    <StackPanel>
                        <DockPanel x:Name="PanelLenX" Margin="0,0,0,5">
                            <Label x:Name="LabelLenX" Content="Length X:" DockPanel.Dock="Left" Width="80"/>
                            <Button DockPanel.Dock="Right" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="CrosshairLength" Click="OnResetSetting"/>
                            <TextBlock Text="{Binding ElementName=SliderLenX, Path=Value, StringFormat=F1}" DockPanel.Dock="Right" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center" Width="30" TextAlignment="Right"/>
                            <Slider x:Name="SliderLenX" Minimum="0" Maximum="100" ValueChanged="OnSliderChanged"/>
                        </DockPanel>
                        
                        <DockPanel x:Name="PanelLenY" Margin="0,0,0,5">
                            <Label Content="Length Y:" DockPanel.Dock="Left" Width="80"/>
                            <Button DockPanel.Dock="Right" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="CrosshairLengthY" Click="OnResetSetting"/>
                            <TextBlock Text="{Binding ElementName=SliderLenY, Path=Value, StringFormat=F1}" DockPanel.Dock="Right" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center" Width="30" TextAlignment="Right"/>
                            <Slider x:Name="SliderLenY" Minimum="0" Maximum="100" ValueChanged="OnSliderChanged"/>
                        </DockPanel>

                        <DockPanel x:Name="PanelThickX" Margin="0,0,0,5">
                            <Label x:Name="LabelThickX" Content="Thick X:" DockPanel.Dock="Left" Width="80"/>
                            <Button DockPanel.Dock="Right" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="LineThickness" Click="OnResetSetting"/>
                            <TextBlock Text="{Binding ElementName=SliderThickX, Path=Value, StringFormat=F1}" DockPanel.Dock="Right" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center" Width="30" TextAlignment="Right"/>
                            <Slider x:Name="SliderThickX" Minimum="0.1" Maximum="30" ValueChanged="OnSliderChanged"/>
                        </DockPanel>

                        <DockPanel x:Name="PanelThickY" Margin="0,0,0,5">
                            <Label Content="Thick Y:" DockPanel.Dock="Left" Width="80"/>
                            <Button DockPanel.Dock="Right" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="LineThicknessY" Click="OnResetSetting"/>
                            <TextBlock Text="{Binding ElementName=SliderThickY, Path=Value, StringFormat=F1}" DockPanel.Dock="Right" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center" Width="30" TextAlignment="Right"/>
                            <Slider x:Name="SliderThickY" Minimum="0.1" Maximum="30" ValueChanged="OnSliderChanged"/>
                        </DockPanel>

                        <DockPanel x:Name="PanelGap" Margin="0,0,0,5">
                            <Label Content="Gap:" DockPanel.Dock="Left" Width="80"/>
                            <Button DockPanel.Dock="Right" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="CrosshairGap" Click="OnResetSetting"/>
                            <TextBlock Text="{Binding ElementName=SliderGap, Path=Value, StringFormat=F1}" DockPanel.Dock="Right" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center" Width="30" TextAlignment="Right"/>
                            <Slider x:Name="SliderGap" Minimum="0" Maximum="100" ValueChanged="OnSliderChanged"/>
                        </DockPanel>

                        <DockPanel Margin="0,0,0,5">
                            <Label Content="Outline:" DockPanel.Dock="Left" Width="80"/>
                            <Button DockPanel.Dock="Right" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="OutlineThickness" Click="OnResetSetting"/>
                            <TextBlock Text="{Binding ElementName=SliderOutline, Path=Value, StringFormat=F1}" DockPanel.Dock="Right" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center" Width="30" TextAlignment="Right"/>
                            <Slider x:Name="SliderOutline" Minimum="0" Maximum="10" ValueChanged="OnSliderChanged"/>
                        </DockPanel>

                        <DockPanel Margin="0,0,0,5">
                            <Label Content="Opacity:" DockPanel.Dock="Left" Width="80"/>
                            <Button DockPanel.Dock="Right" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="CrosshairOpacity" Click="OnResetSetting"/>
                            <TextBlock Text="{Binding ElementName=SliderOpacity, Path=Value, StringFormat=F2}" DockPanel.Dock="Right" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center" Width="30" TextAlignment="Right"/>
                            <Slider x:Name="SliderOpacity" Minimum="0.1" Maximum="1.0" ValueChanged="OnSliderChanged"/>
                        </DockPanel>
                        
                         <DockPanel x:Name="PanelRotation" Margin="0,0,0,5">
                            <Label Content="Rotation:" DockPanel.Dock="Left" Width="80"/>
                            <Button DockPanel.Dock="Right" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="RotationAngle" Click="OnResetSetting"/>
                            <TextBlock Text="{Binding ElementName=SliderRotation, Path=Value, StringFormat=F0}" DockPanel.Dock="Right" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center" Width="30" TextAlignment="Right"/>
                            <Slider x:Name="SliderRotation" Minimum="0" Maximum="360" ValueChanged="OnSliderChanged"/>
                        </DockPanel>

                        <DockPanel Margin="0,0,0,5">
                            <Label Content="Offset X:" DockPanel.Dock="Left" Width="80"/>
                            <Button DockPanel.Dock="Right" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="XOffset" Click="OnResetSetting"/>
                            <TextBlock Text="{Binding ElementName=SliderOffsetX, Path=Value, StringFormat=F0}" DockPanel.Dock="Right" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center" Width="30" TextAlignment="Right"/>
                            <Slider x:Name="SliderOffsetX" Minimum="-500" Maximum="500" ValueChanged="OnSliderChanged"/>
                        </DockPanel>

                        <DockPanel Margin="0,0,0,5">
                            <Label Content="Offset Y:" DockPanel.Dock="Left" Width="80"/>
                            <Button DockPanel.Dock="Right" Style="{StaticResource ResetButtonStyle}" Content="↺" Tag="YOffset" Click="OnResetSetting"/>
                            <TextBlock Text="{Binding ElementName=SliderOffsetY, Path=Value, StringFormat=F0}" DockPanel.Dock="Right" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center" Width="30" TextAlignment="Right"/>
                            <Slider x:Name="SliderOffsetY" Minimum="-500" Maximum="500" ValueChanged="OnSliderChanged"/>
                        </DockPanel>
                    </StackPanel>
                </GroupBox>
                
                <GroupBox Header="Targeting">
                    <StackPanel>
                        <CheckBox x:Name="ProcessCheck" Content="Only show in specific process" Foreground="{StaticResource TextPrimary}"
                                  Checked="OnProcessToggle" Unchecked="OnProcessToggle"/>
                        <TextBox x:Name="ProcessInput" Margin="0,10,0,0" TextChanged="OnProcessTextChanged"/>
                        <TextBlock Text="Example: FortniteClient-Win64-Shipping.exe" FontSize="10" Foreground="Gray" Margin="0,2,0,0"/>
                    </StackPanel>
                </GroupBox>
            </StackPanel>
        </ScrollViewer>

        <Border Grid.Row="2" Background="#252526" BorderBrush="#4a4a4a" BorderThickness="0,1,0,0" Padding="15">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Button x:Name="ToggleBtn" Content="Toggle Visibility" Click="OnToggleVisibility" HorizontalAlignment="Left" Background="#333333"/>
                <Button Grid.Column="1" Content="Save Config" Click="OnSaveConfig" Background="#2d8a4e"/>
            </Grid>
        </Border>
    </Grid>
</Window>